---
## Author
author:
  name: Чигладзе Майя Владиславовна
  degrees: student
  orcid: 0000-0002-0877-7063
  email: 1132239399@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 119530
      city: Москва
      address: ул. Очаковское шоссе, д. 9А

## Title
title: "Отчёт по лабораторной работе №12"
subtitle: "Администрирование сетевых подсистем"
license: "CC BY"
---

# Цель работы

Получение навыков по управлению системным временем и настройке синхронизации времени

# Задание

1. Изучите команды по настройке параметров времени 
2. Настройте сервер в качестве сервера синхронизации времени для локальной сети
3. Напишите скрипты для Vagrant, фиксирующие действия по установке и настройке
NTP-сервера и клиента 

# Теоретическое введение

За синхронизацию времени на узлах сети отвечает протокол NTP (Network Time
Protocol). В его основе лежит специальный алгоритм согласования данных (алгоритм
Марзулло), используемый при выборе источников оценки точного времени.
Источники, с которыми происходит синхронизация времени, располагаются
в иерархической структуре. На нулевом уровне располагаются эталонные устройства
отсчёта времени, которые, в свою очередь, подключены посредством высокоскорост-
ного интерфейса с минимальными задержками к компьютерам, образующим первый
уровень синхронизации и имеющим выход в Интернет. Каждый нижележащий слой

# Выполнение лабораторной работы

## Настройка параметров времени

1. На сервере и клиенте посмотрите параметры настройки даты и времени: timedatectl
Определите, в какой временной зоне находятся сервер и клиент, проводится ли
сетевая синхронизация времени и т.п. Поэкспериментируйте с параметрами этой
команды. (см. рис. @fig-011).

![Смотрим параметры даты](image/1.1.jpg){#fig-011 width=70%}

## Управление синхронизацией времени

1. При необходимости установите на сервере необходимое программное обеспечение:
dnf -y install chrony 

Проверьте источники времени на клиенте и на сервер (см. рис. @fig-012).

![Источники](image/1.2.jpg){#fig-012 width=70%}

•   Активный источник (*): Сервер 27.ip-51-68-44.eu (Stratum 3) в данный момент используется для синхронизации.

•   Выбранные источники (+): Серверы op.success.ovh и mail.raveland.org также выбраны и используются для расчета точного времени.

•   Отброшенный источник (-): Сервер ciran28.fr отброшен, вероятно, из-за слишком большого смещения или нестабильности.

•   Вывод: Сервер успешно синхронизирует свое время с тремя внешними источниками, используя один из них как основной (*).

На сервере откройте на редактирование файл /etc/chrony.conf и добавьте строк (см. рис. @fig-013).

![Редактируем файл](image/1.3.jpg){#fig-013 width=70%}

4. На сервере перезапустите службу chronyd:
systemctl restart chronyd (см. рис. @fig-014).

![Перезапустила службу](image/1.4.jpg){#fig-014 width=70%}

5. Настройте межсетевой экран на сервере:
firewall-cmd --add-service=ntp --permanent
firewall-cmd --reload ([рис. @fig-015]).

![Настроила межсетевой экран](image/1.5.jpg){#fig-015 width=70%}

6. На клиенте откройте файл /etc/chrony.conf и добавьте строку (вместо user укажите
свой логин):
server server.user.net iburst
Удалите все остальные строки с директивой server. ([рис. @fig-016]).

![Открыла файл на редактирование](image/1.6.jpg){#fig-016 width=70%}

7. На клиенте перезапустите службу chronyd:
systemctl restart chronyd ([рис. @fig-017]).

![Перезапустила службу](image/1.7.jpg){#fig-017 width=70%}

8. Проверьте источники времени на клиенте и на сервере:
chronyc sources ([рис. @fig-0181] и [рис. @fig-0182]).

![Проверила источники времени](image/1.8.1.jpg){#fig-0181 width=70%}

![Проверила источники времени](image/1.8.2.jpg){#fig-0182 width=70%}

В отчёте поясните выведенную информацию.
9. Посмотрите подробную информацию о синхронизации и поясните в отчёте выве-
денную на экран информацию.

## Внесение изменений в настройки внутреннего окружения виртуальных машин

1. На виртуальной машине server перейдите в каталог для внесения изменений
в настройки внутреннего окружения /vagrant/provision/server/, создайте в нём
каталог ntp, в который поместите в соответствующие подкаталоги конфигурацион-
ные файлы:
cd /vagrant/provision/server
mkdir -p /vagrant/provision/server/ntp/etc
cp -R /etc/chrony.conf /vagrant/provision/server/ntp/etc/ ([рис. @fig-021]).

![Переходим в каталог](image/2.1.jpg){#fig-021 width=70%}

2. В каталоге /vagrant/provision/server создайте исполняемый файл ntp.sh:
cd /vagrant/provision/server
touch ntp.sh
chmod +x ntp.sh (см. рис. @fig-022).

![Создаем исполняемый файл](image/2.2.1.jpg){#fig-022 width=70%}

3. На виртуальной машине client перейдите в каталог для внесения изменений
в настройки внутреннего окружения /vagrant/provision/client/, создайте в нём
каталог ntp, в который поместите в соответствующие подкаталоги конфигурацион-
ные файлы:
cd /vagrant/provision/client
mkdir -p /vagrant/provision/client/ntp/etc
cp -R /etc/chrony.conf /vagrant/provision/client/ntp/etc/ (см. рис. @fig-023).

![На ВМ вносим в настройки](image/2.3.jpg){#fig-023 width=70%}

4. В каталоге /vagrant/provision/client создайте исполняемый файл ntp.sh:
cd /vagrant/provision/client
touch ntp.sh
chmod +x ntp.sh (см. рис. @fig-024).

![Создаем исполняемый файл](image/2.4.jpg){#fig-024 width=70%}

5. Для отработки созданных скриптов во время загрузки виртуальных машин server
и client в конфигурационном файле Vagrantfile необходимо добавить в соответ-
ствующих разделах конфигураций для сервера и клиента ([рис. @fig-025]).

![Создаем исполняемый файл](image/2.5.jpg){#fig-025 width=70%}

# Выводы

В ходе выполнения лабораторной работы, я получила навыки по управлению системным временем и настройке синхронизации времени

# Список литературы{.unnumbered}

::: {#refs}
:::
