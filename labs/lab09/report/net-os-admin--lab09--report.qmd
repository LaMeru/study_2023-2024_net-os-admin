---
## Author
author:
  name: Чигладзе Майя Владиславовна
  degrees: student
  orcid: 0000-0002-0877-7063
  email: 1132239399@pfur.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 119530
      city: Москва
      address: ул. Очаковское шоссе, д. 9А

## Title
title: "Отчёт по лабораторной работе 9"
subtitle: "Администрирование сетевых подсистем"
license: "CC BY"
---

# Цель работы

Приобретение практических навыков по установке и простейшему конфигурирова-
нию POP3/IMAP-сервера.

# Задание

1. Установите на виртуальной машине server Dovecot и Telnet для дальнейшей про-
верки корректности работы почтового сервера (см. раздел 9.4.1).
2. Настройте Dovecot (см. раздел 9.4.2).
3. Установите на виртуальной машине client программу для чтения почты Evolution
и настройте её для манипуляций с почтой вашего пользователя. Проверьте кор-
ректность работы почтового сервера как с виртуальной машины server, так
и с виртуальной машины client (см. раздел 9.4.3).
Измените скрипт для Vagrant, фиксирующий действия по установке и настройке
4. Postfix и Dovecote во внутреннем окружении виртуальной машины server, создайте
скрипт для Vagrant, фиксирующий действия по установке Evolution во внутрен-
нем окружении виртуальной машины client. Соответствующим образом внесите
изменения в Vagrantfile (см. раздел 9.4.4).


# Теоретическое введение

Dovecot — агент доставки почты (MDA) по протоколам POP3 и IMAP с возможно-
стью обеспечения безопасности и надёжности за счёт использования протокола TLS.
Dovecot поддерживает основные форматы почтовых ящиков: mbox и Maildir.
Все сообщения в почтовом ящике формата mbox находятся в одном текстовом файле.
При любых операциях с почтовым ящиком (чтение, удаление или перемещение со-
общений и т.п.) требуется блокировка при помощи специальных механизмов этого
файла, так как он может быть повреждён при одновременной попытке записи в него
несколькими программами.
При использовании формата Maildir каждое сообщение хранится в отдельном файле
с уникальным именем, а каждая папка представляет собой каталог. Таким образом, не
требуется монопольный захват файла для обеспечения целостности почтового ящика
при чтении, добавлении или изменении сообщений. За блокировку отдельных файлов
сообщений отвечает файловая система.
Конфигурация Dovecot располагается в файле /etc/dovecot/dovecot.conf и в файлах
каталога /etc/dovecot/conf.d. Файл сертификатов безопасности Dovecot располагает-
ся в каталоге /etc/pki/dovecot.
При организации совместной работы SMTP-сервера и POP3/IMAP-сервера может
использоваться одна из двух схем:
1. SMTP-сервер и POP3/IMAP-сервер имеют доступ к списку пользователей и работают
параллельно, разделяя доступ к почтовым ящикам пользователей;
2. SMTP-сервер передаёт все функции по работе с почтовыми ящиками пользователей
POP3/IMAP-серверу, т.е. только POP3/IMAP-сервер имеет доступ к списку пользова-
телей.

# Выполнение лабораторной работы

## Установка Dovecot

На виртуальной машине server войдите под вашим пользователем и откройте тер-
минал. Перейдите в режим суперпользователя (см. рис. @fig-011).

![Зашла в суперпользователя и установила пакеты](image/1.1.jpg){#fig-011 width=70%}

## Настройка dovecot

В конфигурационном файле /etc/dovecot/dovecot.conf пропишите список почто-
вых протоколов, по которым разрешено работать Dovecot([рис. @fig-021]).

![Список почтовых протоколов](image/2.1.jpg){#fig-021 width=70%}

В конфигурационном файле /etc/dovecot/conf.d/10-auth.conf проверьте, что ука-
зан метод аутентификации plain(см. рис. @fig-022).

![Метод аутенфикации](image/2.2.jpg){#fig-022 width=70%}

В конфигурационном файле /etc/dovecot/conf.d/auth-system.conf.ext проверьте,
что для поиска пользователей и их паролей используется pam и файл passwd(см. рис. @fig-023).

![Проверила конфигурационный файл](image/2.3.jpg){#fig-023 width=70%}

В конфигурационном файле /etc/dovecot/conf.d/10-mail.conf настройте место-
расположение почтовых ящиков пользователей(см. рис. @fig-024).

![Настроила местоположение](image/2.4.jpg){#fig-024 width=70%}

В Postfix задайте каталог для доставки почты ([рис. @fig-025]).

![Каталог доставки почты](image/2.5.jpg){#fig-025 width=70%}

Сконфигурируйте межсетевой экран, разрешив работать службам протоколов POP3
и IMAP ([рис. @fig-026]).

![Конфигурация межсетевого экрана](image/2.6.jpg){#fig-026 width=70%}

Восстановите контекст безопасности в SELinux ([рис. @fig-027]).

![Восстановила контекст безопасности](image/2.7_8.jpg){#fig-027 width=70%}

Перезапустите Postfix и запустите Dovecot ([рис. @fig-028]).

![Перезапустите постфикс и запустите довкот](image/2.7_8.jpg){#fig-028 width=70%}

## Проверка работы Dovecot

На дополнительном терминале виртуальной машины server запустите мониторинг
работы почтовой службы ([рис. @fig-031]).

![Запустила мониторин](image/3.1.jpg){#fig-031 width=70%}

На терминале сервера для просмотра имеющейся почты используйте ([рис. @fig-032]).

![Использовала для просмотра почты](image/3.2.jpg){#fig-032 width=70%}

Для просмотра mailbox пользователя на сервере на терминале с правами супер-
пользователя используйте команду ([рис. @fig-033]).

![Просмотрела маилбокс](image/3.3.jpg){#fig-033 width=70%}

На виртуальной машине client войдите под вашим пользователем и откройте тер-
минал. Перейдите в режим суперпользователя ([рис. @fig-034]).

![Зашла в клиент](image/3.4.jpg){#fig-034 width=70%}

Запустите и настройте почтовый клиент Evolution ([рис. @fig-036]).

![Запустила почтовый клиент](image/3.6.jpg){#fig-036 width=70%}

Из почтового клиента отправьте себе несколько тестовых писем, убедитесь, что они
доставлены. ([рис. @fig-038]).

![Из почтового клиента отправила неск писем](image/3.8.jpg){#fig-038 width=70%}

Проверьте работу почтовой службы, используя на сервере протокол Telnet ([рис. @fig-039]).

![Проверила работу почтовой службы](image/3.9.jpg){#fig-039 width=70%}

## Внесение изменений в настройки внутреннего окружения виртуальной машины

На виртуальной машине server перейдите в каталог для внесения изменений в на-
стройки внутреннего окружения /vagrant/provision/server/. В соответствующие
подкаталоги поместите конфигурационные файлы Dovecot ([рис. @fig-041]).

![Внесла изменения в настройки внутреннего окружения](image/4.1.jpg){#fig-041 width=70%}

Внесите изменения в файл /vagrant/provision/server/mail.sh, добавив в него
строки ([рис. @fig-042]).

![Внесла изменения в файл](image/4.2.jpg){#fig-042 width=70%}

На виртуальной машине client в каталоге /vagrant/provision/client скорректи-
руйте файл mail.sh, прописав в нём ([рис. @fig-043]).

![Внесла изменения в файл мэил](image/4.3.jpg){#fig-043 width=70%}

# Выводы

Приобрела практические навыки по установке и простейшему конфигурированию POP3/IMAP-сервера.

# Список литературы{.unnumbered}
1. Dovecot Documentation. — URL: https : / / dovecot . org / documentation (visited on
2. 09/13/2021).
Postfix Documentation. — URL: http://www.postfix.org/documentation.html (visited
on 09/13/2021).
::: {#refs}
:::
